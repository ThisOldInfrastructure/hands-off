# This needs some work.
# At present, it just allows you to tack classes onto the front of the current
# class list -- I feel that there is probably a need to allow the new classes
# to be added at the start of the list, just before or after the one that
# depended on them, or at the end of the list, but until I see examples
# where that extra complication is actually required, lets just do this
#
# BTW this uses the perhaps dodgy trick of relying on being run by something
# that provides the function preseed_fetch, to grab the subclass files
#
# N.B. this reverses the order of the classes specified on the command line,
# which means that the highest priority classes should be specified first there
# so that they end up last here (very biblical ;-)
#
d-i preseed/include_command     string ( set -x; echo $(debconf-get local/classes)|sed -e 's/;/\n/g'> /tmp/cls-; while true; do f=$(ls /tmp/cls-* 2>/dev/null|head -1); [ -z "$f" ] && break; while read cls; do allcls="$cls;$allcls"; preseed_fetch "$(dirname $last_location)/${cls}/subclasses" /tmp/cls-$cls; done < $f; rm $f; done; debconf-set local/classes $(echo $allcls|sed -e 's/^;//') ) > /var/log/class_setup.debug 2>&1
