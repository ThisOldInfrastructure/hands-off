<title>"Hands-off" Debian Installation</title>
<h1>"Hands-off" Debian Installation</h1>

<p><font size="+1"><b>WARNING:</b> <em>don't just blithely try this on a
machine you care about -- it will cheerfully re-partition the hard
disk, and overwrite your data, WITHOUT asking for permission once
you've launched it -- you have been warned.</em></font>

<hr>

<p>This site contains a framework for automatically installing Debian
systems, based on recent (i.e. post-<em>sarge</em>, from svn) versions of
debian-installer.

<p>It relies on a new udeb called auto-install, which is activated by
setting the debconf variable auto-install/enabled to true.  This
delays the kdb-chooser and localechooser udebs until after
network-preseed, allowing them to be presseded via the network.
Another feature of auto-install is to expand preseed/url from a
hostname to a full URL, if only a hostname was provided.

<p>Since this is now based on debian-installer, with only minor
extensions, the build procedure is pretty much exactly the same as
building vanilla d-i from svn, <a
href="http://deasil.hands.com/d-i/trunk/docs/building.html">with a
couple of tweaks</a>.

<h3>dashslashdash is no more</h3>

<p>It's no longer needed, and we've come up with some rather more
meaningful variable names to provide the same functionality

<hr>

<p>This page describes some new features of debian-installer system
that allows automated installation.  If you obtain media that supports
this, you will find that you can (for example) type something like:

<pre>
  boot: auto url=hands.com cls=xen3;loc/uk
</pre>

and get a Xen3 machine installed, with a UK keyboard and timezone.

<h2>Parameters</h2>

<p>The slash-free parameters (like <tt>url</tt>) are actually just
aliases for normal debconf variables.  So far the following aliases
have been defined:

<pre>
auto            auto-install/enabled
cls             auto-install/classes
priority        debconf/priority
url             preseed/url
hostname        netcfg/get_hostname
domain          netcfg/get_domain
file            preseed/file
locale          debian-installer/locale
interface       netcfg/choose_interface
fb              debian-installer/framebuffer
suite		mirror/suite
</pre>

<p>by invoking the auto (or auto24) targets, you're just ensuring that
"auto=true DEBCONF_PRIORITY=critical" is added to the kernel command line.

<h3>url=<em>magic</em></h3>

<p>The auto-install.udeb package provides some magic for creating full
preseed urls from either just a hostname or a fully qualified domain
name.  If you provide a url that contains no slashes, auto-install's
postinst (which is run before network-preseed) assumes that you have
given it a hostname, and replaces it with a URL of the following form:
<pre>
	http://&lt;hostname&gt;/d-i/etch/./preseed.url
</pre>

<p>The <tt>&lt;hostname&gt;</tt> section of that is whatever you
provided as the URL, if it contained any dots, or, if it was without
dots (i.e. it's just the hostname) then the domain is added to it
(with that domain probably being found by netcfg, from a reverse
lookup of your DHCP IP address).  The <tt>etch</tt> bit of the path
matches the release the installer was part of.  The <tt>/./</tt> bit
is used by preseed_fetch as the root of the preseed area, so this is
where paths starting with <tt>/</tt> are anchored.

<p>Boot images with the modifications required are available in the <a
href="media">media</a> directory -- at present the netboot images are
the only ones that have been properly tested -- bug reports welcome.

<hr>

<p>Be aware that the scripts here depend on customised versions of
d-i.  If you're basing significant effort on the current setup, please
mirror all the files (probably with a subversion check-out) so you're
not dependant on me maintaining backwards compatibility</b>

<p>The software is available from the <a href="etch">published
area</a> or you can look at the <a
href="http://svn.hands.com/d-i/">bleeding edge version</a> in svn.

<p>If you find this useful, and have ideas about how to improve it, or
would like to contribute your recipes, please get in touch with <a
href="mailto:&#112;&#104;&#105;&#108;&#064;&#104;&#097;&#110;&#100;&#115;&#046;&#099;&#111;&#109;">Philip
Hands</a>

<p>Have Fun!

<p>Cheers, Phil.
